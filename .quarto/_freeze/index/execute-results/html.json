{
  "hash": "99a19b63587c01717a16112c8c78a31c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Final Project: [Sexual Education, Contraceptive Use, & Pregnancy Risk]\"\nauthor: \"Belen Zemas & Amel Attalla\"\ndate: \"2025-06-26\"\nparams:\n  number: 6\n  purpose: \"Final project for PUBH 6199: Visualizing Data with R\"\nformat: \n  html:\n    toc: true\n    toc-location: right\n    code-fold: true\n    theme: minty\n    self-contained: true\nexecute:\n  echo: true\n  warning: false\n  message: false\noutput-dir: docs\n---\n\n\n\n\n## Introduction\n\n_Briefly introduce your topic and research question._\n\n## Data\n\n_Describe your data source(s), including where it came from, the key variables, and any pre-processing steps._\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries and data\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(haven)\n\nraw_data <- read_dta(\"data/Guttmacher 2009 Survey of contraceptive knowledge (Fog Zone).dta\")\n\nclean_fogzone <- raw_data %>% \n  select(gender,age4grps,race,riskr,abstonly,protect,curmethrr,pregknowr,totknowr,nummthdsr,wprotect,mprotect) %>% \n  rename(\n    Current_most_effective_method = curmethrr,\n    Pregnancy_knowledge = pregknowr,\n    BC_method_knowledge = totknowr,\n    BC_methods_heard_about = nummthdsr,\n    Age = age4grps,\n    Women_protection_status = wprotect,\n    Men_protection_status = mprotect,\n    Protection_status = protect\n  ) %>% \n  mutate(\n    gender = case_when(\n      gender == 1 ~ \"Female\",\n      gender == 2 ~ \"Male\",\n      TRUE ~ NA_character_\n    ),\n    race = case_when(\n      race == 1 ~ \"Hispanic\",\n      race == 2 ~ \"Non-Hispanic White\",\n      race == 3 ~ \"Non-hispanic Black\",\n      race == 4 ~ \"Asian\",\n      race == 5 ~ \"Other\",\n      TRUE ~ NA_character_\n    ),\n    Age = case_when(\n      Age == 1 ~ \"18-19\",\n      Age == 2 ~ \"20-21\",\n      Age == 3 ~ \"22-24\",\n      Age == 4 ~ \"25-29\",\n      TRUE ~ NA_character_\n    ),\n    riskr = case_when(\n      riskr == 1 ~ \"No\",\n      riskr == 2 ~ \"Yes\",\n      TRUE ~ NA_character_\n    ), \n    abstonly = case_when(\n      abstonly == 1 ~ \"Abstinence Only\",\n      abstonly == 2 ~ \"Abstinence Focused\",\n      abstonly == 3 ~ \"Contraceptive Focused\",\n      is.na(abstonly) ~ \"No sex ed/ don't know\",\n      TRUE ~ NA_character_\n    ), \n    Protection_status = case_when(\n      Protection_status == 1 ~ \"Well protected\",\n      Protection_status == 2 ~ \"Unprotected\",\n      Protection_status == 3 ~ \"Uncertain status\",\n      Protection_status == 7 ~ \"No Sex\",\n      TRUE ~ NA_character_\n    ),\n    Women_protection_status = case_when(\n      Women_protection_status == 1 ~ \"perfect pill use\",\n      Women_protection_status == 2 ~ \"perfect condom use\",\n      Women_protection_status == 3 ~ \"perfect depo use\",\n      Women_protection_status == 4 ~ \"long-acting method\",\n      Women_protection_status == 5 ~ \"skipped pills\",\n      Women_protection_status == 6 ~ \"missed condom use\",\n      Women_protection_status == 7 ~ \"depo late\",\n      Women_protection_status == 8 ~ \"other method\",\n      Women_protection_status == 9 ~ \"no method - likely at risk\",\n      Women_protection_status == 17 ~ \"no method - unkown risk\",\n      Women_protection_status == 19 ~ \"no sex ever/last 12 mo\",\n      TRUE ~ NA_character_\n    ),\n    Men_protection_status = case_when(\n      Men_protection_status == 1 ~ \"use horm/larc\",\n      Men_protection_status == 2 ~ \"perfect condom use\",\n      Men_protection_status == 3 ~ \"inconsistent condom use\",\n      Men_protection_status == 4 ~ \"withdrawl\",\n      Men_protection_status == 5 ~ \"other/unknown\",\n      Men_protection_status == 6 ~ \"no method - risk likely\",\n      Men_protection_status == 7 ~ \"no method - unknown risk\",\n      Men_protection_status == 8 ~ \"no sex ever/ last 12 mo\",\n      TRUE ~ NA_character_\n    ), \n    Current_most_effective_method = case_when(\n      Current_most_effective_method == 1 ~ \"long-acting alone\",\n      Current_most_effective_method == 2 ~ \"long-acting + condom\",\n      Current_most_effective_method == 3 ~ \"hormonal alone\",\n      Current_most_effective_method == 4 ~ \"hormonal + condoms\",\n      Current_most_effective_method == 5 ~ \"condoms\",\n      Current_most_effective_method == 6 ~ \"withdrawl/NFP\",\n      Current_most_effective_method == 7 ~ \"other/unknown\",\n      Current_most_effective_method == 17 ~ \"no method - risk unknown\",\n      Current_most_effective_method == 18 ~ \"no method - likely at risk\",\n      Current_most_effective_method == 19 ~ \"no sex ever/ last 12 mo\",\n      TRUE ~ NA_character_\n    ),\n    Pregnancy_knowledge = case_when(\n      Pregnancy_knowledge == 1 ~ \"0-3 correct\",\n      Pregnancy_knowledge == 4 ~ \"4 correct\",\n      Pregnancy_knowledge == 5 ~ \"5 correct\",\n      Pregnancy_knowledge == 6 ~ \"6 correct\",\n      TRUE ~ NA_character_\n    ),\n    BC_method_knowledge = case_when(\n      BC_method_knowledge == 1 ~ \"0-7 correct\",\n      BC_method_knowledge == 2 ~ \"8-11 correct\",\n      BC_method_knowledge == 3 ~ \"12-15 correct\",\n      BC_method_knowledge == 4 ~ \"16-18 correct\",\n      BC_method_knowledge == 5 ~ \"19+ correct\",\n      TRUE ~ NA_character_\n    ),\n    BC_methods_heard_about = case_when(\n      BC_methods_heard_about == 1 ~ \"0-6 methods\",\n      BC_methods_heard_about == 2 ~ \"7-10 methods\",\n      BC_methods_heard_about== 3 ~ \"11-13 methods\",\n      BC_methods_heard_about == 4 ~ \"14-16 methods\",\n      TRUE ~ NA_character_\n    )\n  )\n```\n:::\n\n\n## Visualization 1: [Sexual Health Education and Risk of Unintended Pregnancy]\n\n_Describe what this plot shows, and why it's important._\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# your code here\nlibrary(ggplot2)\nlibrary(viridis)\nlibrary(dplyr)\n\nclean_fogzone <- readRDS(\"data/clean_fogzone.rds\")\n\n\nclean_fogzone_factors <- clean_fogzone %>%\n  mutate(\n    abstonly = factor(\n      abstonly,\n      levels = c(\"No sex ed/ don't know\", \"Abstinence Only\", \"Abstinence Focused\", \"Contraceptive Focused\")\n    ),\n    riskr = factor(riskr, levels = c(\"No\", \"Yes\"))\n  )\n\nggplot(clean_fogzone_factors, aes(x = abstonly, fill = riskr)) +\n  geom_bar(position = position_dodge(width = 0.9)) +\n  geom_text(stat = \"count\", aes(label = ..count..), \n            position = position_dodge(width = 0.9), \n            vjust = -0.4, size = 3.5) +\n  scale_fill_viridis_d(\n    name = \"At Risk?\",\n    labels = c(\"No\", \"Yes\"),\n    option = \"D\"\n  ) +\nlabs(\n  title = \"Sexual Health Education and Risk of Unintended Pregnancy\",\n  x = \"Type of Sexual Health Education Recived\",\n  y = \"Number of Participants\"\n  ) + \ntheme_minimal(base_size = 14) +\ntheme(\n  axis.text.x = element_text(angle = 20, hjust = 1, face = \"bold\", size = 10),\n  axis.text.y = element_text(face = \"bold\"),\n  plot.title = element_text(face = \"bold\"),\n  legend.position = \"top\"\n)\n```\n\n::: {.cell-output-display}\n![](figs/unnamed-chunk-2-1.png){width=696.192}\n:::\n:::\n\n\n## Visualization 2: [Title Here]\n\n_Describe what this plot shows, and why it's important._\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# your code here\n```\n:::\n\n\n## Visualization 3: [Does sex education type affect the type of contraception used?]\n\nThis question examines whether the type of sex education individuals received influences their current contraceptive behavior. Using the variable abstonly, we categorize respondents by whether they received abstinence-focused education, comprehensive sex education, or no sex education. We then analyze their reported contraceptive method. The goal is to identify whether sex education is associated with the use of more effective or consistent contraceptive methods, offering insight into how educational content may shape real-life health decisions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggalluvial)\n\nd <- read_csv(\"clean_fogzone.csv\")\n\nsankey_data <- d %>%\n  select(abstonly, Current_most_effective_method) %>%\n  filter(\n    !is.na(abstonly),\n    !is.na(Current_most_effective_method),\n    !str_detect(str_to_lower(Current_most_effective_method), \"no sex|refused|don't know\")\n  ) %>%\n  count(abstonly, Current_most_effective_method) %>%\n  rename(sex_ed = abstonly, method = Current_most_effective_method) %>%\n  mutate(\n    sex_ed = case_when(\n      sex_ed == \"Abstinence Focused\" ~ \"Abstinence-Focused\",\n      sex_ed == \"Abstinence Only\" ~ \"Abstinence Only\",\n      sex_ed == \"Contraceptive Focused\" ~ \"Comprehensive\",\n      sex_ed == \"No sex ed/ don't know\" ~ \"No/Don't Know\",\n      TRUE ~ sex_ed\n    ),\n    method = case_when(\n      method == \"hormonal + condoms\" ~ \"Hormonal + Condoms\",\n      method == \"hormonal alone\" ~ \"Hormonal Alone\",\n      method == \"long-acting alone\" ~ \"LARC Alone\",\n      method == \"long-acting + condom\" ~ \"LARC + Condom\",\n      method == \"no method - likely at risk\" ~ \"No Method (Likely Risk)\",\n      method == \"no method - risk unknown\" ~ \"No Method (Unknown Risk)\",\n      method == \"other/unknown\" ~ \"Other/Unknown\",\n      method == \"withdrawal/NFP\" ~ \"Withdrawal / NFP\",\n      TRUE ~ method\n    )\n  )\n\np <- ggplot(sankey_data,\n            aes(axis1 = sex_ed, axis2 = method, y = n)) +\n  geom_alluvium(aes(fill = sex_ed), width = 1/15) +\n  geom_stratum(width = 1/15, fill = \"orange\", color = \"black\") +\n  scale_x_discrete(\n    limits = c(\"Sex Education Type\", \"Contraceptive Method\"),\n    expand = c(.05, .05)\n  ) +\n  labs(\n    title = \"Sex Ed Type â†’ Current Contraceptive Method\",\n    y = \"Number of People\",\n    fill = \"Sex Education\"\n  ) +\n  theme_classic()\n\n\nstrata_data <- ggplot_build(p)$data[[2]]\n\np +\n  geom_text(data = strata_data %>% filter(x == 1),\n            aes(x = x - 0.05, y = y, label = stratum),\n            hjust = 1, size = 3, inherit.aes = FALSE) +\n  geom_text(data = strata_data %>% filter(x == 2),\n            aes(x = x + 0.05, y = y, label = stratum),\n            hjust = 0, size = 3, inherit.aes = FALSE)\n```\n\n::: {.cell-output-display}\n![](figs/unnamed-chunk-4-1.png){width=696.192}\n:::\n:::\n\n\n## OR Shiny app: [Title Here]\n\n_If you choose to create a Shiny app, describe the app's purpose and functionality. Save your code inside the shiny-app/ folder, replace the URL below with your app's URL_\n\n[Click here to open the interactive Shiny app](https://cindyhu.shinyapps.io/two-files-app/)\n\n## Interpretation\n\n_Summarize your key findings. What do your visualizations reveal?_\n\n## Limitations\n\n_Discuss any data quality or design limitations._\n\n## Conclusion\n\n_Wrap up your project with a takeaway message or next steps._\n\n## References\n\n_Include any references to data sources, packages, or literature you used. If your visualization design is inspired by someone else's work, cite those too._\n\n1. Reference 1\n2. Reference 2\n3. Reference 3\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}